import{p as T,s as y,r as m,k as C,o as i,g as E,h as I,l as U,d as a,t as b,w as g,y as f,c,j as v,n as P,C as j,D}from"./index-C7CxpWWS.js";import{_ as V}from"./AdminLayout.vue_vue_type_script_setup_true_lang-CPyLgjyA.js";import{_ as $}from"./PageBreadcrumb.vue_vue_type_script_setup_true_lang-CSu2Ug9g.js";import{g as z,E as _,p as B}from"./endpoint-CWcXRKaZ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const F={class:"rounded-xl border bg-white dark:bg-white/5 p-6 md:p-10 space-y-6"},G={class:"grid gap-8 md:grid-cols-[220px_1fr]"},L={class:"flex flex-col items-center"},R=["src"],M={class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},O={class:"grid md:grid-cols-2 gap-5"},W={class:"flex justify-end mt-6"},q=["disabled"],H={key:0},J={key:1},K={key:2,class:"animate-spin h-5 w-5 border-2 border-white border-t-transparent rounded-full"},se=T({__name:"AdminSettings",setup(Q){const w="https://fivliaproject.s3.eu-north-1.amazonaws.com",x=j(),n=y({show:!1,message:"",type:"success"}),p=(e,s="success")=>{n.message=e,n.type=s,n.show=!0,setTimeout(()=>{n.show=!1},3e3)},r=m(!1),d=m(null),u=m(""),l=m("No profile photo selected"),t=y({name:"",email:"",password:"",image:"",term_and_conditons:"",radius:""}),k=e=>{if(!e)return"/no-image.png";if(/^https?:\/\//i.test(e))return e;const s=w.replace(/\/+$/,""),o=e.startsWith("/")?e:`/${e}`;return`${s}${o}`},S=async()=>{D(),await x.replace("/signin")},h=async()=>{try{const e=await z(_.GET_SETTING);e.data&&(u.value="",t.name=e.data.name||"",t.email=e.data.email||"",t.password="",t.image=e.data.image||"",t.term_and_conditons=e.data.term_and_conditons||"",t.radius=e.data.radius||"",l.value=t.image?"Current photo loaded":"No profile photo selected")}catch{p("Failed to load admin settings","error")}},N=async()=>{r.value=!0;try{const e=new FormData;e.append("name",t.name||""),e.append("email",t.email||""),t.password.trim()&&e.append("password",t.password.trim()),d.value&&e.append("image",d.value),await B(_.UPDATE_SETTING,e),t.password="",d.value=null,l.value="No profile photo selected",await h(),p("Settings updated successfully")}catch{p("Failed to update settings","error")}finally{r.value=!1}},A=e=>{var o;const s=(o=e.target.files)==null?void 0:o[0];s&&(d.value=s,u.value=URL.createObjectURL(s),l.value=s.name)};return C(h),(e,s)=>(i(),E(V,null,{default:I(()=>[U($,{pageTitle:"Admin Settings"}),a("div",F,[a("section",null,[a("div",{class:"mb-4 flex items-center justify-between gap-3"},[s[3]||(s[3]=a("h2",{class:"text-xl font-semibold"},"Admin Settings",-1)),a("button",{onClick:S,class:"inline-flex items-center rounded-lg border border-red-300 px-4 py-2 text-sm font-medium text-red-600 hover:bg-red-50 dark:border-red-700/60 dark:text-red-400 dark:hover:bg-red-900/20"}," Logout ")]),a("div",G,[a("div",L,[a("img",{src:u.value||k(t.image),class:"w-36 h-36 rounded-full object-cover border"},null,8,R),s[4]||(s[4]=a("label",{for:"adminProfileImage",class:"mt-3 inline-flex cursor-pointer items-center rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300"}," Choose Profile Photo ",-1)),a("input",{id:"adminProfileImage",type:"file",accept:"image/*",onChange:A,class:"hidden"},null,32),a("p",M,b(l.value),1)]),a("div",O,[g(a("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>t.name=o),placeholder:"Admin Name",class:"border p-2 rounded"},null,512),[[f,t.name]]),g(a("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>t.email=o),type:"email",placeholder:"Admin Email",class:"border p-2 rounded"},null,512),[[f,t.email]]),g(a("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>t.password=o),type:"password",placeholder:"Admin Password (optional)",class:"border p-2 rounded md:col-span-2"},null,512),[[f,t.password]])])]),a("div",W,[a("button",{onClick:N,disabled:r.value,class:"px-6 py-3 bg-indigo-600 text-white rounded flex items-center gap-2 disabled:opacity-50"},[r.value?(i(),c("span",J,"Saving...")):(i(),c("span",H,"Save Settings")),r.value?(i(),c("span",K)):v("",!0)],8,q)])])]),n.show?(i(),c("div",{key:0,class:P(["fixed top-6 right-6 z-50 px-6 py-4 rounded-lg shadow-lg text-white transition-all duration-300",n.type==="success"?"bg-green-600":"bg-red-600"]),style:{"z-index":"99999"}},b(n.message),3)):v("",!0)]),_:1}))}});export{se as default};
